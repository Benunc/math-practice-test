<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CP Statistical Modeling - Advanced Practice Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            padding: 20px;
            color: #212529;
        }
        .container {
            max-width: 1050px;
            margin: 0 auto;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.25);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1f4037 0%, #99f2c8 100%);
            color: white;
            padding: 28px;
            text-align: center;
        }
        .header h1 { font-size: 2em; margin-bottom: 8px; }
        .stats-bar {
            background: #f8f9fa;
            padding: 18px 26px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e9ecef;
            flex-wrap: wrap;
            gap: 12px;
        }
        .scoreboard { display: flex; gap: 24px; align-items: center; }
        .score-item { display: flex; flex-direction: column; align-items: center; }
        .score-label { font-size: 0.85em; color: #6c757d; margin-bottom: 4px; }
        .score-value { font-size: 1.8em; font-weight: bold; }
        .score-correct { color: #28a745; }
        .score-wrong { color: #dc3545; }
        .score-unanswered { color: #6c757d; }
        .progress-container { flex: 1; min-width: 240px; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.9em; color: #6c757d; }
        .progress-bar {
            width: 100%; height: 25px; background: #e9ecef; border-radius: 12px;
            overflow: hidden; position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            transition: width 0.3s ease;
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold; font-size: 0.85em;
        }
        .content { padding: 26px; }
        .part-header {
            background: #f1f3f5;
            padding: 12px 16px;
            margin: 28px 0 16px 0;
            border-left: 5px solid #1f4037;
            border-radius: 4px;
            font-size: 1.1em;
            font-weight: 700;
            color: #2d3436;
        }
        .question {
            margin-bottom: 26px;
            padding: 18px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .question.answered { border-color: #28a745; background: #f0fff4; }
        .question-number { font-weight: 700; color: #1f4037; margin-bottom: 8px; font-size: 1.05em; }
        .question-text { margin-bottom: 12px; line-height: 1.6; }
        .question-text table { margin: 12px 0; border-collapse: collapse; width: 100%; max-width: 420px; }
        .question-text th, .question-text td { border: 1px solid #dee2e6; padding: 8px; text-align: left; }
        .question-text th { background: #e9ecef; font-weight: 600; }
        .options { margin-top: 10px; }
        .option {
            margin: 8px 0;
            padding: 12px;
            background: #fff;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex; align-items: center;
        }
        .option:hover { border-color: #1f4037; background: #eef7f4; }
        .option input[type="radio"], .option input[type="checkbox"] { margin-right: 12px; width: 18px; height: 18px; cursor: pointer; }
        .option.selected { border-color: #1f4037; background: #e7f3ff; }
        .option.correct { border-color: #28a745; background: #d4edda; }
        .option.incorrect { border-color: #dc3545; background: #f8d7da; }
        .text-input {
            width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 6px;
            font-size: 1em; margin-top: 8px;
        }
        .text-input:focus { outline: none; border-color: #1f4037; }
        .button-group { text-align: center; margin-top: 24px; padding-top: 18px; border-top: 2px solid #e9ecef; }
        .btn {
            padding: 12px 28px; font-size: 1em; border: none; border-radius: 8px;
            cursor: pointer; margin: 0 8px; transition: all 0.3s ease; font-weight: 700;
        }
        .btn-primary { background: linear-gradient(135deg, #1f4037 0%, #99f2c8 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(31,64,55,0.35); }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #5a6268; }
        .results { display: none; padding: 24px; text-align: center; }
        .results.show { display: block; }
        .results h2 { color: #1f4037; margin-bottom: 14px; }
        .final-score { font-size: 2.6em; font-weight: 800; margin: 14px 0; color: #28a745; }
        @media (max-width: 768px) {
            .stats-bar { flex-direction: column; align-items: stretch; }
            .scoreboard { justify-content: space-around; width: 100%; }
            .header h1 { font-size: 1.6em; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>CP Statistical Modeling - Advanced Practice Test</h1>
            <p>Challenging review to deepen conceptual understanding</p>
        </div>

        <div class="stats-bar">
            <div class="scoreboard">
                <div class="score-item">
                    <div class="score-label">Correct</div>
                    <div class="score-value score-correct" id="correct-count">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Wrong</div>
                    <div class="score-value score-wrong" id="wrong-count">0</div>
                </div>
                <div class="score-item">
                    <div class="score-label">Unanswered</div>
                    <div class="score-value score-unanswered" id="unanswered-count">0</div>
                </div>
            </div>
            <div class="progress-container">
                <div class="progress-label">
                    <span>Progress</span>
                    <span id="progress-text">0 / 0</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%">0%</div>
                </div>
            </div>
        </div>

        <div class="content" id="test-content">
            <!-- Questions injected by JS -->
        </div>

        <div class="button-group">
            <button class="btn btn-primary" onclick="checkAnswers()">Check Answers</button>
            <button class="btn btn-secondary" onclick="resetTest()">Reset Test</button>
        </div>

        <div class="results" id="results">
            <h2>Test Complete!</h2>
            <div class="final-score" id="final-score">0%</div>
            <p id="results-text"></p>
        </div>
    </div>

    <script>
        // Harder, concept-focused questions with verified answers
        const questions = [
            {
                id: 'q1',
                part: 'Part I: Data & Distributions',
                number: 1,
                text: 'Which variables are categorical? Select all that apply.',
                type: 'multiple',
                options: [
                    { id: 'A', text: 'Favorite color' },
                    { id: 'B', text: 'Number of absences in a semester' },
                    { id: 'C', text: 'Club membership (yes/no)' },
                    { id: 'D', text: 'GPA on a 0–4 scale' },
                    { id: 'E', text: 'Time to run a mile (minutes)' }
                ],
                correct: ['A', 'C']
            },
            {
                id: 'q2',
                part: 'Part I: Data & Distributions',
                number: 2,
                text: 'A two-way table of Tardy status by Gender is shown. What is P(Tardy | Female)?<br><br><table><tr><th></th><th>Tardy</th><th>Not Tardy</th><th>Total</th></tr><tr><th>Male</th><td>12</td><td>30</td><td>42</td></tr><tr><th>Female</th><td>8</td><td>32</td><td>40</td></tr><tr><th>Total</th><td>20</td><td>62</td><td>82</td></tr></table>',
                type: 'single',
                options: [
                    { id: 'A', text: '8%' },
                    { id: 'B', text: '16%' },
                    { id: 'C', text: '20%' },
                    { id: 'D', text: '25%' }
                ],
                correct: ['C'] // 8/40 = 0.20
            },
            {
                id: 'q3',
                part: 'Part I: Data & Distributions',
                number: 3,
                text: 'Test scores are approximately Normal with mean 72 and standard deviation 8. About what percent of students score between 64 and 80?',
                type: 'single',
                options: [
                    { id: 'A', text: '50%' },
                    { id: 'B', text: '68%' },
                    { id: 'C', text: '84%' },
                    { id: 'D', text: '95%' }
                ],
                correct: ['B'] // Within 1 SD ~68%
            },
            {
                id: 'q4',
                part: 'Part I: Data & Distributions',
                number: 4,
                text: 'A student scored 95 on a test with mean 78 and standard deviation 7. Is the score unusual?',
                type: 'single',
                options: [
                    { id: 'A', text: 'No, z ≈ 1.5' },
                    { id: 'B', text: 'No, z ≈ 2.0' },
                    { id: 'C', text: 'Yes, z ≈ 2.43 (> 2)' },
                    { id: 'D', text: 'Yes, because it is below the mean' }
                ],
                correct: ['C'] // z = (95-78)/7 ≈ 2.43
            },
            {
                id: 'q5',
                part: 'Part I: Data & Distributions',
                number: 5,
                text: 'Data: 12, 14, 18, 21, 22, 24, 25, 25, 26, 27, 40. What is the upper fence (Q3 + 1.5·IQR)?',
                type: 'single',
                options: [
                    { id: 'A', text: '32' },
                    { id: 'B', text: '34' },
                    { id: 'C', text: '36' },
                    { id: 'D', text: '38' }
                ],
                correct: ['D'] // Q1=18, Q3=26, IQR=8, fence=26+12=38
            },
            {
                id: 'q6',
                part: 'Part II: Regression & Correlation',
                number: 6,
                text: 'A regression model is y = 5.2x + 12, where x = hours studied and y = predicted test score. What does the slope mean?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Each extra hour studied increases predicted score by 5.2 points.' },
                    { id: 'B', text: 'Each extra point increases study time by 5.2 hours.' },
                    { id: 'C', text: 'At x=0, the predicted score is 5.2.' },
                    { id: 'D', text: 'Scores are perfectly predicted by study hours.' }
                ],
                correct: ['A']
            },
            {
                id: 'q7',
                part: 'Part II: Regression & Correlation',
                number: 7,
                text: 'Using the model y = 5.2x + 12, a student studied 10 hours and scored 88. What is the residual?',
                type: 'single',
                options: [
                    { id: 'A', text: '-24 (model over-predicts by 24)' },
                    { id: 'B', text: '24 (model under-predicts by 24)' },
                    { id: 'C', text: '-12 (model over-predicts by 12)' },
                    { id: 'D', text: '12 (model under-predicts by 12)' }
                ],
                correct: ['B'] // Pred = 5.2*10+12=64; residual=88-64=24
            },
            {
                id: 'q8',
                part: 'Part II: Regression & Correlation',
                number: 8,
                text: 'A scatterplot shows a strong downward trend with points tightly clustered. Which best describes the correlation?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Close to +1' },
                    { id: 'B', text: 'Close to 0' },
                    { id: 'C', text: 'Moderately positive' },
                    { id: 'D', text: 'Close to -1' }
                ],
                correct: ['D']
            },
            {
                id: 'q9',
                part: 'Part III: Sampling & Bias',
                number: 9,
                text: 'A researcher randomly picks a starting student, then surveys every 6th student who enters the cafeteria. What sampling method is this?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Simple random sample' },
                    { id: 'B', text: 'Stratified sample' },
                    { id: 'C', text: 'Cluster sample' },
                    { id: 'D', text: 'Systematic sample' }
                ],
                correct: ['D']
            },
            {
                id: 'q10',
                part: 'Part III: Sampling & Bias',
                number: 10,
                text: 'Survey question: “Do you agree that responsible students should be allowed to miss curfew occasionally?” What bias is most likely?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Undercoverage' },
                    { id: 'B', text: 'Nonresponse' },
                    { id: 'C', text: 'Response (leading wording)' },
                    { id: 'D', text: 'Voluntary response' }
                ],
                correct: ['C']
            },
            {
                id: 'q11',
                part: 'Part IV: Inference - Means & Proportions',
                number: 11,
                text: 'A sample of n = 36 has mean 82 and standard deviation 10. Compute a 95% CI for the population mean (use z ≈ 1.96).',
                type: 'single',
                options: [
                    { id: 'A', text: '(80.4, 83.6)' },
                    { id: 'B', text: '(78.7, 85.3)' },
                    { id: 'C', text: '(77.0, 87.0)' },
                    { id: 'D', text: '(75.2, 88.8)' }
                ],
                correct: ['B'] // SE=10/6=1.6667; ME=1.96*1.667≈3.27; 82±3.27
            },
            {
                id: 'q12',
                part: 'Part IV: Inference - Means & Proportions',
                number: 12,
                text: 'In a sample of 200 students, 140 prefer online homework. Compute a 95% CI for the population proportion.',
                type: 'single',
                options: [
                    { id: 'A', text: '(0.63, 0.77)' },
                    { id: 'B', text: '(0.60, 0.80)' },
                    { id: 'C', text: '(0.55, 0.85)' },
                    { id: 'D', text: '(0.48, 0.92)' }
                ],
                correct: ['A'] // p̂=0.70; SE=sqrt(.7*.3/200)=0.0324; ME≈0.0635; (0.636,0.764)
            },
            {
                id: 'q13',
                part: 'Part IV: Inference - Means & Proportions',
                number: 13,
                text: 'Conditions for using the Central Limit Theorem for a sample mean (select all that apply).',
                type: 'multiple',
                options: [
                    { id: 'A', text: 'Random/representative sample' },
                    { id: 'B', text: 'Independent observations' },
                    { id: 'C', text: 'Large n or population is approximately Normal' },
                    { id: 'D', text: 'Population at least 10× sample size if sampling without replacement' },
                    { id: 'E', text: 'Population must always be Normal' },
                    { id: 'F', text: 'Sample size must equal population size' }
                ],
                correct: ['A', 'B', 'C', 'D']
            },
            {
                id: 'q14',
                part: 'Part IV: Inference - Means & Proportions',
                number: 14,
                text: 'A hypothesis test yields p-value = 0.012 with α = 0.05. What is the correct decision?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Reject H₀; evidence suggests the alternative is true.' },
                    { id: 'B', text: 'Fail to reject H₀; evidence suggests the alternative is false.' },
                    { id: 'C', text: 'Reject H₀; evidence suggests the alternative is false.' },
                    { id: 'D', text: 'Fail to reject H₀; evidence is strong for the alternative.' }
                ],
                correct: ['A']
            },
            {
                id: 'q15',
                part: 'Part IV: Inference - Means & Proportions',
                number: 15,
                text: 'What is a Type I error in hypothesis testing?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Failing to reject a false null (missed effect)' },
                    { id: 'B', text: 'Rejecting a true null (false positive)' },
                    { id: 'C', text: 'Rejecting a false null (correct decision)' },
                    { id: 'D', text: 'Failing to reject a true null (correct decision)' }
                ],
                correct: ['B']
            },
            {
                id: 'q16',
                part: 'Part V: Comparing Groups',
                number: 16,
                text: 'To compare average hours of sleep between two independent groups of students (population SD unknown), which procedure is appropriate?',
                type: 'single',
                options: [
                    { id: 'A', text: 'One-sample z test for a mean' },
                    { id: 'B', text: 'Two-sample t test for means' },
                    { id: 'C', text: 'Matched-pairs t test' },
                    { id: 'D', text: 'Two-proportion z test' }
                ],
                correct: ['B']
            },
            {
                id: 'q17',
                part: 'Part V: Comparing Groups',
                number: 17,
                text: 'How does increasing the sample size affect a confidence interval (keeping confidence level the same)?',
                type: 'single',
                options: [
                    { id: 'A', text: 'Interval becomes narrower' },
                    { id: 'B', text: 'Interval becomes wider' },
                    { id: 'C', text: 'Interval does not change' },
                    { id: 'D', text: 'Interval becomes biased' }
                ],
                correct: ['A']
            },
            {
                id: 'q18',
                part: 'Part V: Comparing Groups',
                number: 18,
                text: 'A distribution is approximately Normal with mean 70 and SD 4. Is a value of 80 unusual?',
                type: 'single',
                options: [
                    { id: 'A', text: 'No, z = 1.5' },
                    { id: 'B', text: 'No, z = 2.0' },
                    { id: 'C', text: 'Yes, z = 2.5 (> 2)' },
                    { id: 'D', text: 'Yes, because it is below the mean' }
                ],
                correct: ['C'] // z = (80-70)/4 = 2.5
            }
        ];

        let userAnswers = {};
        let checked = false;

        function initTest() {
            const content = document.getElementById('test-content');
            content.innerHTML = '';
            let currentPart = '';
            questions.forEach(q => {
                if (q.part !== currentPart) {
                    currentPart = q.part;
                    const partHeader = document.createElement('div');
                    partHeader.className = 'part-header';
                    partHeader.textContent = q.part;
                    content.appendChild(partHeader);
                }
                const qDiv = document.createElement('div');
                qDiv.className = 'question';
                qDiv.id = `q-${q.id}`;

                const qNum = document.createElement('div');
                qNum.className = 'question-number';
                qNum.textContent = `Question ${q.number}`;
                qDiv.appendChild(qNum);

                const qText = document.createElement('div');
                qText.className = 'question-text';
                qText.innerHTML = q.text;
                qDiv.appendChild(qText);

                if (q.type === 'single' || q.type === 'multiple') {
                    const opts = document.createElement('div');
                    opts.className = 'options';
                    q.options.forEach(opt => {
                        const optDiv = document.createElement('div');
                        optDiv.className = 'option';

                        const input = document.createElement('input');
                        input.type = q.type === 'single' ? 'radio' : 'checkbox';
                        input.name = q.id;
                        input.value = opt.id;
                        input.id = `${q.id}-${opt.id}`;
                        input.addEventListener('change', () => handleAnswer(q.id));

                        const label = document.createElement('label');
                        label.htmlFor = `${q.id}-${opt.id}`;
                        label.textContent = `${opt.id}. ${opt.text}`;
                        label.style.cursor = 'pointer';
                        label.style.flex = '1';

                        optDiv.appendChild(input);
                        optDiv.appendChild(label);
                        optDiv.addEventListener('click', (e) => {
                            if (e.target !== input) {
                                input.checked = q.type === 'multiple' ? !input.checked : true;
                                handleAnswer(q.id);
                            }
                        });
                        opts.appendChild(optDiv);
                    });
                    qDiv.appendChild(opts);
                } else if (q.type === 'text') {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'text-input';
                    input.id = `${q.id}-input`;
                    input.placeholder = 'Type your answer here...';
                    input.addEventListener('input', () => handleAnswer(q.id));
                    qDiv.appendChild(input);
                }
                content.appendChild(qDiv);
            });
            updateStats();
        }

        function handleAnswer(questionId) {
            const q = questions.find(x => x.id === questionId);
            if (!q) return;
            if (q.type === 'single') {
                const sel = document.querySelector(`input[name="${questionId}"]:checked`);
                userAnswers[questionId] = sel ? [sel.value] : [];
            } else if (q.type === 'multiple') {
                const selected = Array.from(document.querySelectorAll(`input[name="${questionId}"]:checked`)).map(i => i.value);
                userAnswers[questionId] = selected;
            } else if (q.type === 'text') {
                const input = document.getElementById(`${questionId}-input`);
                userAnswers[questionId] = input ? input.value.trim() : '';
            }
            const qDiv = document.getElementById(`q-${questionId}`);
            const ans = userAnswers[questionId];
            if (ans && (Array.isArray(ans) ? ans.length > 0 : ans !== '')) {
                qDiv.classList.add('answered');
            } else {
                qDiv.classList.remove('answered');
            }
            updateStats();
        }

        function updateStats() {
            let correct = 0, wrong = 0, unanswered = 0;
            const total = questions.length;
            questions.forEach(q => {
                const ans = userAnswers[q.id];
                if (!ans || (Array.isArray(ans) && ans.length === 0) || (typeof ans === 'string' && ans === '')) {
                    unanswered++;
                } else if (checked) {
                    if (isCorrect(q, ans)) correct++; else wrong++;
                }
            });
            document.getElementById('correct-count').textContent = correct;
            document.getElementById('wrong-count').textContent = wrong;
            document.getElementById('unanswered-count').textContent = unanswered;

            const answered = total - unanswered;
            const progress = total ? (answered / total) * 100 : 0;
            document.getElementById('progress-fill').style.width = `${progress}%`;
            document.getElementById('progress-fill').textContent = `${Math.round(progress)}%`;
            document.getElementById('progress-text').textContent = `${answered} / ${total}`;
        }

        function isCorrect(q, userAns) {
            if (q.type === 'text') {
                const correct = q.correct.toLowerCase().trim();
                const ans = userAns.toLowerCase().trim();
                return ans === correct;
            }
            const correct = [...q.correct].sort().join(',');
            const ans = Array.isArray(userAns) ? [...userAns].sort().join(',') : userAns;
            return correct === ans;
        }

        function checkAnswers() {
            checked = true;
            let correct = 0, wrong = 0;
            questions.forEach(q => {
                const ans = userAnswers[q.id];
                const qDiv = document.getElementById(`q-${q.id}`);
                const isAnsCorrect = ans && isCorrect(q, ans);
                if (q.type === 'single' || q.type === 'multiple') {
                    q.options.forEach(opt => {
                        const optDiv = document.querySelector(`#${q.id}-${opt.id}`).closest('.option');
                        const isSel = Array.isArray(ans) ? ans.includes(opt.id) : ans === opt.id;
                        const isCor = q.correct.includes(opt.id);
                        optDiv.classList.remove('selected');
                        if (isCor) optDiv.classList.add('correct');
                        else if (isSel && !isCor) optDiv.classList.add('incorrect');
                    });
                } else if (q.type === 'text') {
                    const input = document.getElementById(`${q.id}-input`);
                    if (!input) return;
                    if (isAnsCorrect) { input.style.borderColor = '#28a745'; input.style.background = '#d4edda'; }
                    else { input.style.borderColor = '#dc3545'; input.style.background = '#f8d7da'; }
                }
                if (isAnsCorrect) correct++; else if (ans && (Array.isArray(ans) ? ans.length > 0 : ans !== '')) wrong++;
            });
            updateStats();
            const total = questions.length;
            const score = total ? Math.round((correct / total) * 100) : 0;
            document.getElementById('final-score').textContent = `${score}%`;
            document.getElementById('results-text').textContent = `You got ${correct} out of ${total} correct.`;
            document.getElementById('results').classList.add('show');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function resetTest() {
            checked = false;
            userAnswers = {};
            const resultDiv = document.getElementById('results');
            resultDiv.classList.remove('show');
            initTest();
        }

        initTest();
    </script>
</body>
</html>

